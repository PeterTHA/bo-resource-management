# การตั้งค่า Gmail App Password สำหรับระบบส่งอีเมล

เพื่อให้ระบบสามารถส่งอีเมลผ่าน Gmail ได้ คุณจำเป็นต้องสร้าง App Password เนื่องจาก Gmail มีระบบรักษาความปลอดภัยที่เข้มงวด และไม่อนุญาตให้แอปพลิเคชันภายนอกใช้รหัสผ่านปกติในการเข้าถึง

## ขั้นตอนการสร้าง App Password

1. **เปิดใช้งานการยืนยันตัวตนสองชั้น (2FA)**
   - เข้าสู่ระบบ Google Account ของคุณที่ [myaccount.google.com](https://myaccount.google.com)
   - ไปที่ "Security" (ความปลอดภัย)
   - เปิดใช้งาน "2-Step Verification" (การยืนยันตัวตนสองขั้นตอน)
   - ทำตามขั้นตอนเพื่อตั้งค่าการยืนยันตัวตนสองชั้น

2. **สร้าง App Password**
   - ไปที่ [App Passwords page](https://myaccount.google.com/apppasswords)
   - ในส่วน "Select app" เลือก "Other (Custom name)"
   - ตั้งชื่อเช่น "ระบบจัดการทรัพยากรบุคคล" หรือ "Resource Management System"
   - คลิก "Generate"
   - Google จะสร้างรหัสผ่านให้ (ตัวอย่าง: `xxxx xxxx xxxx xxxx`)
   - **สำคัญ**: คัดลอกรหัสผ่านนี้ไว้ทันที เพราะจะไม่สามารถเรียกดูได้อีกหลังจากปิดหน้าต่างนี้

3. **ตั้งค่าในไฟล์ `.env.development.local` หรือ `.env.production.local`**

```env
EMAIL_PROVIDER=gmail
EMAIL_HOST=smtp.gmail.com
EMAIL_PORT=465
EMAIL_SECURE=true
EMAIL_USER=peter@codedsolution.io
EMAIL_PASS=xxxx xxxx xxxx xxxx  # ใส่ App Password ที่ได้รับจาก Google
EMAIL_FROM=peter@codedsolution.io
```

## ข้อควรระวัง

1. **อย่าใส่เครื่องหมายช่องว่างระหว่างรหัส**
   - เมื่อคัดลอกรหัสจาก Google ให้ลบช่องว่างออก
   - ตัวอย่างที่ถูกต้อง: `xxxxxxxxxxxxxxxx` (ไม่มีช่องว่าง)

2. **App Password ให้สิทธิเข้าถึงอีเมลของคุณ**
   - รักษารหัสนี้ให้ปลอดภัย
   - ไม่ควรคอมมิตลงใน Git หรือแชร์กับผู้อื่น

3. **จำกัดการใช้งาน**
   - App Password นี้ควรใช้เฉพาะสำหรับระบบนี้เท่านั้น
   - หากไม่ใช้งานแล้ว ให้ลบออกจากการตั้งค่า Google Account

4. **การแก้ไขปัญหา**
   - หากพบปัญหาในการส่งอีเมล ให้ตรวจสอบว่าได้เปิดใช้งาน "Less secure app access" ใน Google Account
   - ส่งเมลในโดเมนเดียวกับอีเมล Gmail ที่ใช้ (เพื่อป้องกันการถูกมองว่าเป็นสแปม)

## การทดสอบ

เมื่อตั้งค่าเรียบร้อยแล้ว ระบบจะใช้บัญชี Gmail ของคุณในการส่งอีเมลต่างๆ เช่น:
- อีเมลแจ้งรหัสผ่านเมื่อสร้างบัญชีพนักงานใหม่
- อีเมลแจ้งรหัสผ่านใหม่เมื่อรีเซ็ตรหัสผ่าน
- อีเมลแจ้งเตือนต่างๆ ในระบบ

หากไม่ต้องการใช้ Gmail สามารถแก้ไขการตั้งค่าในไฟล์ `.env.local` เพื่อใช้บริการอีเมลอื่นได้ 